{"id":"aAbG","dependencies":[{"name":"D:\\poc\\react-embedd\\package.json","includedInParent":true,"mtime":1691423031586},{"name":"react","loc":{"line":1,"column":51,"index":51},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react\\index.js"},{"name":"axios","loc":{"line":3,"column":18,"index":80},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\axios\\index.js"},{"name":"js-cookie","loc":{"line":4,"column":20,"index":109},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\js-cookie\\dist\\js.cookie.js"},{"name":"react-icons/bs","loc":{"line":5,"column":35,"index":157},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react-icons\\bs\\index.esm.js"},{"name":"react-icons/lia","loc":{"line":6,"column":40,"index":215},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react-icons\\lia\\index.esm.js"},{"name":"../hooks/recordAudio","loc":{"line":7,"column":29,"index":263},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\src\\hooks\\recordAudio.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=c(require(\"react\")),t=s(require(\"axios\")),r=s(require(\"js-cookie\")),n=require(\"react-icons/bs\"),a=require(\"react-icons/lia\"),o=s(require(\"../hooks/recordAudio\"));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}function c(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(\"default\"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function l(e){return d(e)||f(e)||y(e)||i()}function i(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function f(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function d(e){if(Array.isArray(e))return g(e)}function p(e,t,r,n,a,o,s){try{var u=e[o](s),c=u.value}catch(l){return void r(l)}u.done?t(c):Promise.resolve(c).then(n,a)}function m(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){p(o,n,a,s,u,\"next\",e)}function u(e){p(o,n,a,s,u,\"throw\",e)}s(void 0)})}}function v(e,t){return w(e)||b(e,t)||y(e,t)||h()}function h(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function y(e,t){if(e){if(\"string\"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,a,o,s,u=[],c=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(i){l=!0,a=i}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw a}}return u}}function w(e){if(Array.isArray(e))return e}var x=\"https://justvoicebackend-vrtx.vercel.app\",k={role:\"system\",content:\"Your an helpfull assistant that understands users queries properly and gives them sensible answers in any language if you detect some other language make sure your writing them in english only\"},E=null,S=function(s){var u=s.siteURL,c=v((0,e.useState)([k]),2),i=c[0],f=c[1],d=v((0,e.useState)([]),2),p=d[0],h=d[1],y=v((0,e.useState)(\"\"),2),g=y[0],b=y[1],w=v((0,e.useState)(!1),2),E=w[0],S=(w[1],v((0,e.useState)(!1),2)),j=S[0],A=S[1],O=v((0,e.useState)(!1),2),R=(O[0],O[1],v((0,e.useState)(null),2)),I=(R[0],R[1],(0,o.default)()),N=I.startRecording,P=I.stopRecording,_=(I.togglePauseResume,I.recordingBlob),T=I.isRecording,M=(I.isPaused,I.recordingTime,function(){var e=m(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:P(),console.log(\"hii\");case 2:case\"end\":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}());(0,e.useEffect)(function(){q(_)},[_]);var q=function(){var e=m(regeneratorRuntime.mark(function e(t){var r,n,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(\"packet sent\"),e.prev=1,(r=new FormData).append(\"file\",t,\"audio.wav\"),r.append(\"model\",\"whisper-1\"),r.append(\"language\",\"en\"),n=x+\"/api/voicechat\",e.next=9,fetch(n,{method:\"POST\",body:r});case 9:if(!(a=e.sent).ok){e.next=21;break}return console.log(\"Audio sent to the API successfully.\"),e.next=14,a.json();case 14:o=e.sent,s=o.text,o.error,D(s),console.log(\"response\",s),e.next=22;break;case 21:console.error(\"Failed to send audio to the API.\");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),console.error(\"Error sending audio to the API:\",e.t0);case 27:case\"end\":return e.stop()}},e,null,[[1,24]])}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=m(regeneratorRuntime.mark(function e(r){var n,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return\"21m00Tcm4TlvDq8ikWAM\",\"https://api.elevenlabs.io/v1/text-to-speech\",n={\"Content-Type\":\"application/json\",\"xi-api-key\":\"2deb078ea46d326f322b86cb3220bdf8\"},a={text:r,model_id:\"eleven_monolingual_v1\",voice_settings:{stability:0,similarity_boost:0,style:.5,use_speaker_boost:!0}},e.prev=4,e.next=7,t.default.post(\"\".concat(\"https://api.elevenlabs.io/v1/text-to-speech\",\"/\").concat(\"21m00Tcm4TlvDq8ikWAM\"),a,{headers:n,responseType:\"blob\"});case 7:if(200!==(o=e.sent).status){e.next=15;break}return console.log(\"hey texted\"),(s=new Audio(URL.createObjectURL(o.data))).play(),e.abrupt(\"return\",{status:200,audio:s});case 15:return e.abrupt(\"return\",{status:405,audio:\"some error\"});case 16:e.next=21;break;case 18:return e.prev=18,e.t0=e.catch(4),e.abrupt(\"return\",{status:400,audio:e.t0});case 21:case\"end\":return e.stop()}},e,null,[[4,18]])}));return function(t){return e.apply(this,arguments)}}();(0,e.useEffect)(function(){i.length>1&&\"system\"!==i[i.length-1].role&&L(),console.log(\"messagesarray\",i),console.log(\"products are\",p)},[i,p]);var D=function(e){var t={role:\"user\",content:e};f(function(e){return[].concat(l(e),[t])})},L=function(){var e=m(regeneratorRuntime.mark(function e(){var n,a,o,s,c,d,p,m,v,y,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=\"chat_memory\",a=r.default.get(n)?JSON.parse(r.default.get(n)):\"\",o={role:\"system\",content:\"this is the summary of conversation i know \"+a},e.prev=3,s={conversationId:r.default.get(\"convoId\")?r.default.get(\"convoId\"):\"\",textInput:i[i.length-1].content,siteURL:u},c=x+\"/api/chatgpt/openai\",e.next=8,t.default.post(c,{input:s,summary:o});case 8:return d=e.sent,e.next=11,d.data;case 11:if(p=e.sent,m=p.result,v=p.summary,y=p.convoId,s.conversationId.length<1&&r.default.set(\"convoId\",y),!m.content){e.next=24;break}return f(function(e){return[].concat(l(e),[m])}),e.next=20,C(m.content);case 20:r.default.remove(n),r.default.set(n,JSON.stringify(v)),e.next=30;break;case 24:console.log(\"result is\",m),h(m.result),g={role:\"user\",content:null,result:m.result},f(function(e){return[].concat(l(e),[g])}),r.default.remove(n),r.default.set(n,JSON.stringify(v));case 30:e.next=35;break;case 32:e.prev=32,e.t0=e.catch(3),console.error(\"Error:\",e.t0);case 35:case\"end\":return e.stop()}},e,null,[[3,32]])}));return function(){return e.apply(this,arguments)}}();return e.default.createElement(e.default.Fragment,null,j?e.default.createElement(\"div\",{className:\"chat-container\"},e.default.createElement(\"div\",{className:\"chat-head\"},e.default.createElement(\"h1\",null,u),e.default.createElement(\"div\",null,e.default.createElement(a.LiaAngleDoubleDownSolid,{onClick:function(){return A(!1)},className:\"closeicon\",color:\"white\"}))),e.default.createElement(\"div\",{className:\"flex-1 bg-white flex items-start justify-start\"},e.default.createElement(\"div\",{className:\"message-body\"},i.map(function(t,r){return e.default.createElement(\"div\",{key:r,className:\"message-container \".concat(\"user\"===t.role?\"user-message\":\"bot-message\")},\"user\"===t.role&&e.default.createElement(\"img\",{src:\"https://img.freepik.com/premium-vector/young-smiling-man-avatar-man-with-brown-beard-mustache-hair-wearing-yellow-sweater-sweatshirt-3d-vector-people-character-illustration-cartoon-minimal-style_365941-860.jpg\",alt:\"User Avatar\",className:\"avatar\"}),e.default.createElement(\"div\",{className:\"message-bubble \".concat(t.role)},e.default.createElement(\"p\",{className:\"msg-body\"},t.content)),\"system\"===t.role&&e.default.createElement(\"img\",{alt:\"Bot Avatar\",src:\"https://herobot.app/wp-content/uploads/2022/11/AI-bot-1.jpg\",className:\"avatar\"}))}))),e.default.createElement(\"div\",{className:\"chat-input\"},e.default.createElement(\"input\",{type:\"text\",className:\"chat-input-text\",placeholder:\"Type your message...\",onChange:function(e){return b(e.target.value)},onKeyPress:function(e){\"Enter\"===e.key&&(\"\"!=g?(D(g),b(\"\")):alert(\"no input\"))}}),e.default.createElement(\"button\",{onClick:T?M:function(){N()}},T?\"Stop Recording\":\"Start Recording\"),E&&e.default.createElement(\"p\",null,\"Microphone access blocked. Please allow microphone access to use this feature.\"))):e.default.createElement(\"div\",{onClick:function(){return A(!0)},className:\"chaticon\"},e.default.createElement(n.BsFillChatLeftFill,null)))},j=S;exports.default=j;"},"sourceMaps":null,"error":null,"hash":"4f3bba58dd29cb5c981c7a532b716d69","cacheData":{"env":{}}}