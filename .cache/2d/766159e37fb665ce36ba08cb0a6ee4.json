{"id":"aAbG","dependencies":[{"name":"D:\\poc\\react-embedd\\package.json","includedInParent":true,"mtime":1691600123862},{"name":"react","loc":{"line":1,"column":51,"index":51},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react\\index.js"},{"name":"axios","loc":{"line":3,"column":18,"index":80},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\axios\\index.js"},{"name":"js-cookie","loc":{"line":4,"column":20,"index":109},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\js-cookie\\dist\\js.cookie.js"},{"name":"react-icons/bs","loc":{"line":5,"column":35,"index":157},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react-icons\\bs\\index.esm.js"},{"name":"react-icons/lia","loc":{"line":6,"column":40,"index":215},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\node_modules\\react-icons\\lia\\index.esm.js"},{"name":"../hooks/recordAudio","loc":{"line":7,"column":29,"index":263},"parent":"D:\\poc\\react-embedd\\src\\components\\ChatBot.js","resolved":"D:\\poc\\react-embedd\\src\\hooks\\recordAudio.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=i(require(\"react\")),t=u(require(\"axios\")),r=u(require(\"js-cookie\")),n=require(\"react-icons/bs\"),a=require(\"react-icons/lia\"),o=u(require(\"../hooks/recordAudio\"));function u(e){return e&&e.__esModule?e:{default:e}}function c(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}function i(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(\"default\"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var u=a?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function s(e){return d(e)||f(e)||h(e)||l()}function l(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function f(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function d(e){if(Array.isArray(e))return g(e)}function m(e,t,r,n,a,o,u){try{var c=e[o](u),i=c.value}catch(s){return void r(s)}c.done?t(i):Promise.resolve(i).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function u(e){m(o,n,a,u,c,\"next\",e)}function c(e){m(o,n,a,u,c,\"throw\",e)}u(void 0)})}}function v(e,t){return w(e)||b(e,t)||h(e,t)||y()}function y(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function h(e,t){if(e){if(\"string\"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,a,o,u,c=[],i=!0,s=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);i=!0);}catch(l){s=!0,a=l}finally{try{if(!i&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(s)throw a}}return c}}function w(e){if(Array.isArray(e))return e}var x=\"https://justvoicebackend-vrtx.vercel.app\",k=null,E=function(u){var c=u.siteURL,i={role:\"system\",content:\"I am an AI Assistant of \".concat(c,\"  here to help you with your queries. You can ask me anything about our products and services.\")},l=v((0,e.useState)([i]),2),f=l[0],d=l[1],m=v((0,e.useState)([]),2),y=m[0],h=m[1],g=v((0,e.useState)(\"\"),2),b=g[0],w=g[1],k=v((0,e.useState)(!1),2),E=k[0],S=(k[1],v((0,e.useState)(!1),2)),A=S[0],j=S[1],O=(0,o.default)(),I=O.startRecording,N=O.stopRecording,P=(O.togglePauseResume,O.recordingBlob),R=O.isRecording,q=(O.isPaused,O.recordingTime,function(){var e=p(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:N();case 1:case\"end\":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}());(0,e.useEffect)(function(){M(P)},[P]);var M=function(){var e=p(regeneratorRuntime.mark(function e(t){var r,n,a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=new FormData).append(\"file\",t,\"audio.wav\"),r.append(\"language\",\"en\"),n=x+\"/api/voicechat\",e.next=7,fetch(n,{method:\"POST\",body:r});case 7:if(!(a=e.sent).ok){e.next=17;break}return e.next=11,a.json();case 11:o=e.sent,u=o.text,o.error,C(u),e.next=18;break;case 17:console.error(\"Failed to send audio to the API.\");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.error(\"Error sending audio to the API:\",e.t0);case 23:case\"end\":return e.stop()}},e,null,[[0,20]])}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=p(regeneratorRuntime.mark(function e(t){var r,n,a,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=x+\"/api/readvoice\",e.prev=1,e.next=4,fetch(r,{method:\"POST\",body:JSON.stringify({text:t})});case 4:if(200!==(n=e.sent).status){e.next=12;break}return e.next=8,n.arrayBuffer();case 8:a=e.sent,o=new AudioContext,u=o.createBufferSource(),o.decodeAudioData(a,function(e){u.buffer=e,u.connect(o.destination),u.start()});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(\"error\",e.t0);case 17:case\"end\":return e.stop()}},e,null,[[1,14]])}));return function(t){return e.apply(this,arguments)}}();(0,e.useEffect)(function(){f.length>1&&\"system\"!==f[f.length-1].role&&D()},[f,y]);var C=function(e){var t={role:\"user\",content:e};d(function(e){return[].concat(s(e),[t])})},D=function(){var e=p(regeneratorRuntime.mark(function e(){var n,a,o,u,c,i,l,m,p,v,y;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=\"chat_memory\",a=r.default.get(n)?JSON.parse(r.default.get(n)):\"\",o={role:\"system\",content:\"this is the summary of conversation i know \"+a},e.prev=3,u={conversationId:r.default.get(\"convoId\")?r.default.get(\"convoId\"):\"\",textInput:f[f.length-1].content,siteURL:\"nani.pk\"},c=x+\"/api/chatgpt/openai\",e.next=8,t.default.post(c,{input:u,summary:o});case 8:return i=e.sent,e.next=11,i.data;case 11:if(l=e.sent,m=l.result,p=l.summary,v=l.convoId,u.conversationId.length<1&&r.default.set(\"convoId\",v),!(m.content.length>0)){e.next=25;break}return d(function(e){return[].concat(s(e),[m])}),console.log(\"result\"),e.next=21,_(m.content);case 21:r.default.remove(n),r.default.set(n,JSON.stringify(p)),e.next=29;break;case 25:h(m.result),d(function(e){return[].concat(s(e),[m])}),r.default.remove(n),r.default.set(n,JSON.stringify(p));case 29:e.next=38;break;case 31:return e.prev=31,e.t0=e.catch(3),y={role:\"system\",content:\"Sorry, I am not able to understand your query. Please try again.\"},d(function(e){return[].concat(s(e),[y])}),e.next=37,_(y.content);case 37:console.error(\"Error:\",e.t0);case 38:case\"end\":return e.stop()}},e,null,[[3,31]])}));return function(){return e.apply(this,arguments)}}();return e.default.createElement(e.default.Fragment,null,A?e.default.createElement(\"div\",{className:\"chat-container\"},e.default.createElement(\"div\",{className:\"chat-head\"},e.default.createElement(\"h1\",null,c),e.default.createElement(\"div\",null,e.default.createElement(a.LiaAngleDoubleDownSolid,{onClick:function(){return j(!1)},className:\"closeicon\",color:\"white\"}))),e.default.createElement(\"div\",{className:\"flex-1 bg-white flex items-start justify-start\"},e.default.createElement(\"div\",{className:\"message-body\"},f.map(function(t,r){return e.default.createElement(\"div\",{key:r,className:\"message-container \".concat(\"user\"===t.role?\"user-message\":\"bot-message\")},\"user\"===t.role&&e.default.createElement(\"img\",{src:\"https://img.freepik.com/premium-vector/young-smiling-man-avatar-man-with-brown-beard-mustache-hair-wearing-yellow-sweater-sweatshirt-3d-vector-people-character-illustration-cartoon-minimal-style_365941-860.jpg\",alt:\"User Avatar\",className:\"avatar\"}),e.default.createElement(\"div\",{className:\"message-bubble \".concat(t.role)},e.default.createElement(\"p\",{className:\"msg-body\"},t.content)),\"system\"===t.role&&e.default.createElement(\"img\",{alt:\"Bot Avatar\",src:\"https://herobot.app/wp-content/uploads/2022/11/AI-bot-1.jpg\",className:\"avatar\"}))}))),e.default.createElement(\"div\",{className:\"chat-input\"},e.default.createElement(\"input\",{type:\"text\",className:\"chat-input-text\",placeholder:\"Type your message...\",onChange:function(e){return w(e.target.value)},onKeyPress:function(e){\"Enter\"===e.key&&(\"\"!=b?(C(b),w(\"\")):alert(\"no input\"))}}),e.default.createElement(\"button\",{onClick:R?q:function(){I()}},R?\"Stop Recording\":\"Start Recording\"),E&&e.default.createElement(\"p\",null,\"Microphone access blocked. Please allow microphone access to use this feature.\"))):e.default.createElement(\"div\",{onClick:function(){return j(!0)},className:\"chaticon\"},e.default.createElement(n.BsFillChatLeftFill,null)))},S=E;exports.default=S;"},"sourceMaps":null,"error":null,"hash":"9ac5a69f5626c2d63bf1f8663437df2d","cacheData":{"env":{}}}