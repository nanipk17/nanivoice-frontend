{"id":"DTJt","dependencies":[{"name":"D:\\poc\\react-embedd\\package.json","includedInParent":true,"mtime":1691600123862},{"name":"react","loc":{"line":1,"column":43,"index":43},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\react\\index.js"},{"name":"./chat-button","loc":{"line":2,"column":23,"index":75},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\chat-button\\index.jsx"},{"name":"./header","loc":{"line":3,"column":19,"index":111},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\header\\index.jsx"},{"name":"./input","loc":{"line":4,"column":18,"index":141},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\input\\index.jsx"},{"name":"./body","loc":{"line":5,"column":17,"index":169},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\body\\index.jsx"},{"name":"axios","loc":{"line":6,"column":18,"index":197},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\axios\\index.js"},{"name":"./alert","loc":{"line":8,"column":18,"index":226},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\alert\\index.jsx"},{"name":"js-cookie","loc":{"line":9,"column":20,"index":257},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\js-cookie\\dist\\js.cookie.js"},{"name":"react-icons/bs","loc":{"line":11,"column":34,"index":306},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\react-icons\\bs\\index.esm.js"},{"name":"../../hooks/recordAudio","loc":{"line":12,"column":29,"index":353},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\hooks\\recordAudio.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=d(require(\"react\")),t=l(require(\"./chat-button\")),r=l(require(\"./header\")),n=l(require(\"./input\")),o=l(require(\"./body\")),a=l(require(\"axios\")),u=l(require(\"./alert\")),c=l(require(\"js-cookie\")),i=require(\"react-icons/bs\"),s=l(require(\"../../hooks/recordAudio\"));function l(e){return e&&e.__esModule?e:{default:e}}function f(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(\"default\"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function p(e){return h(e)||m(e)||x(e)||v()}function v(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function m(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function h(e){if(Array.isArray(e))return w(e)}function y(e,t,r,n,o,a,u){try{var c=e[a](u),i=c.value}catch(s){return void r(s)}c.done?t(i):Promise.resolve(i).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function u(e){y(a,n,o,u,c,\"next\",e)}function c(e){y(a,n,o,u,c,\"throw\",e)}u(void 0)})}}function b(e,t){return S(e)||j(e,t)||x(e,t)||_()}function _(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function x(e,t){if(e){if(\"string\"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===r&&e.constructor&&(r=e.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(e):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function j(e,t){var r=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=r){var n,o,a,u,c=[],i=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);i=!0);}catch(l){s=!0,o=l}finally{try{if(!i&&null!=r.return&&(u=r.return(),Object(u)!==u))return}finally{if(s)throw o}}return c}}function S(e){if(Array.isArray(e))return e}var k=\"https://justvoicebackend-vrtx.vercel.app\",O=function(u){var i=u.siteURL,l=u.lang,f={role:\"system\",content:\"urdu\"===l?\"میں یہاں آپ کے سوالات میں مدد کرنے کے لئے نانی ڈاٹ پی کے اے آئی اسسٹنٹ ہوں. آپ مجھ سے ہماری مصنوعات اور خدمات کے بارے میں کچھ پوچھ سکتے ہیں.\":\"I am an AI Assistant of ${siteURL}  here to help you with your queries. You can ask me anything about our products and services.\"},d=b((0,e.useState)(!1),2),v=d[0],m=d[1],h=b((0,e.useState)([]),2),y=h[0],_=h[1],x=b((0,e.useState)(\"\"),2),w=x[0],j=x[1],S=b((0,e.useState)([f]),2),O=S[0],I=S[1],R=function(){m(!v)};(0,e.useEffect)(function(){console.log(v)},[v]);var A=(0,s.default)(),P=A.startRecording,E=A.stopRecording,q=(A.togglePauseResume,A.recordingBlob),N=A.isRecording,M=(A.isPaused,A.recordingTime,function(){var e=g(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:E();case 1:case\"end\":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}());(0,e.useEffect)(function(){B(q)},[q]);var B=function(){var e=g(regeneratorRuntime.mark(function e(t){var r,n,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(r=new FormData).append(\"file\",t,\"audio.wav\"),r.append(\"language\",\"en\"),\"http://localhost:3000\",n=k+\"/api/gcloud/gtest2\",e.next=8,fetch(n,{method:\"POST\",body:r});case 8:if(!(o=e.sent).ok){e.next=17;break}return e.next=12,o.json();case 12:a=e.sent,u=a.text,C(u),e.next=18;break;case 17:console.error(\"Failed to send audio to the API.\");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.error(\"Error sending audio to the API:\",e.t0);case 23:case\"end\":return e.stop()}},e,null,[[0,20]])}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=g(regeneratorRuntime.mark(function e(t){var r,n,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=k+\"/api/readvoice\",\"\",e.prev=2,e.next=5,fetch(r,{method:\"POST\",body:JSON.stringify({text:t,voiceId:\"IKne3meq5aSn9XLyUdCD\"})});case 5:if(200!==(n=e.sent).status){e.next=13;break}return e.next=9,n.arrayBuffer();case 9:o=e.sent,a=new AudioContext,u=a.createBufferSource(),a.decodeAudioData(o,function(e){u.buffer=e,u.connect(a.destination),u.start()});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(\"error\",e.t0);case 18:case\"end\":return e.stop()}},e,null,[[2,15]])}));return function(t){return e.apply(this,arguments)}}();(0,e.useEffect)(function(){O.length>1&&\"system\"!==O[O.length-1].role&&D()},[O,y]);var C=function(e){var t={role:\"user\",content:e};I(function(e){return[].concat(p(e),[t])})},D=function(){var e=g(regeneratorRuntime.mark(function e(){var t,r,n,o,u,s,f,d,v,m,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=\"chat_memory\",r=c.default.get(t)?JSON.parse(c.default.get(t)):\"\",n={role:\"system\",content:\"this is the summary of conversation i know \"+r},e.prev=3,o={conversationId:c.default.get(\"convoId\")?c.default.get(\"convoId\"):\"\",textInput:O[O.length-1].content,siteURL:i},u=k+\"/api/chatgpt/openai\",e.next=8,a.default.post(u,{input:o,summary:n});case 8:return s=e.sent,e.next=11,s.data;case 11:if(f=e.sent,d=f.result,v=f.summary,m=f.convoId,o.conversationId.length<1&&c.default.set(\"convoId\",m),!(d.content.length>0)){e.next=25;break}return I(function(e){return[].concat(p(e),[d])}),console.log(\"result\"),e.next=21,T(d.content);case 21:c.default.remove(t),c.default.set(t,JSON.stringify(v)),e.next=29;break;case 25:_(d.result),I(function(e){return[].concat(p(e),[d])}),c.default.remove(t),c.default.set(t,JSON.stringify(v));case 29:e.next=39;break;case 31:return e.prev=31,e.t0=e.catch(3),\"معذرت، میں آپ کے سوال کو سمجھنے کے قابل نہیں ہوں۔ دوبارہ کوشش کریں.\",h={role:\"system\",content:\"en\"==l?\"Sorry, I am not able to understand your query. Please try again.\":\"معذرت، میں آپ کے سوال کو سمجھنے کے قابل نہیں ہوں۔ دوبارہ کوشش کریں.\"},I(function(e){return[].concat(p(e),[h])}),e.next=38,T(h.content);case 38:console.error(\"Error:\",e.t0);case 39:case\"end\":return e.stop()}},e,null,[[3,31]])}));return function(){return e.apply(this,arguments)}}();return e.default.createElement(\"div\",{className:\"justvoice__widget\"},e.default.createElement(\"div\",{className:\"justvoice__chatBtn \".concat(v?\"justvoice__chatBtn__open\":\"justvoice__chatBtn__close\")},e.default.createElement(t.default,{prompt:w,handleTextSubmit:function(e){\"\"!=e?(C(e),j(\"\")):alert(\"no input\")},toggleChat:R,chatOpen:v})),e.default.createElement(\"div\",{className:\"\".concat(v?\"justvoice__chat__size__open\":\"justvoice__chat__size__close\",\" justvoice__chat__main\")},e.default.createElement(r.default,{toggleChat:R}),e.default.createElement(\"div\",{className:\"justvoice__chat__x2b3f5h9c8\"},e.default.createElement(o.default,{messages:O})),e.default.createElement(n.default,{prompt:w,setPrompt:j,handleStartRecording:function(){P()},handleStopRecording:M,isRecording:N})))},I=O;exports.default=I;"},"sourceMaps":null,"error":null,"hash":"2c71a4ad0aa6bdf5dfcf996a5895029b","cacheData":{"env":{}}}