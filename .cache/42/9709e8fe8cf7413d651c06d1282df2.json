{"id":"DTJt","dependencies":[{"name":"D:\\poc\\react-embedd\\package.json","includedInParent":true,"mtime":1691600123862},{"name":"react","loc":{"line":1,"column":43,"index":43},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\react\\index.js"},{"name":"./chat-button","loc":{"line":2,"column":23,"index":75},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\chat-button\\index.jsx"},{"name":"./header","loc":{"line":3,"column":19,"index":111},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\header\\index.jsx"},{"name":"./input","loc":{"line":4,"column":18,"index":141},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\input\\index.jsx"},{"name":"./body","loc":{"line":5,"column":17,"index":169},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\components\\chat\\body\\index.jsx"},{"name":"axios","loc":{"line":6,"column":18,"index":197},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\axios\\index.js"},{"name":"js-cookie","loc":{"line":8,"column":20,"index":228},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\node_modules\\js-cookie\\dist\\js.cookie.js"},{"name":"../../hooks/recordAudio","loc":{"line":10,"column":29,"index":272},"parent":"D:\\poc\\react-embedd\\src\\components\\chat\\index.jsx","resolved":"D:\\poc\\react-embedd\\src\\hooks\\recordAudio.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=l(require(\"react\")),t=i(require(\"./chat-button\")),n=i(require(\"./header\")),r=i(require(\"./input\")),o=i(require(\"./body\")),a=i(require(\"axios\")),u=i(require(\"js-cookie\")),c=i(require(\"../../hooks/recordAudio\"));function i(e){return e&&e.__esModule?e:{default:e}}function s(e){if(\"function\"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||\"object\"!=typeof e&&\"function\"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(\"default\"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var u=o?Object.getOwnPropertyDescriptor(e,a):null;u&&(u.get||u.set)?Object.defineProperty(r,a,u):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function f(e){return v(e)||p(e)||b(e)||d()}function d(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function p(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function v(e){if(Array.isArray(e))return _(e)}function m(e,t,n,r,o,a,u){try{var c=e[a](u),i=c.value}catch(s){return void n(s)}c.done?t(i):Promise.resolve(i).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function u(e){m(a,r,o,u,c,\"next\",e)}function c(e){m(a,r,o,u,c,\"throw\",e)}u(void 0)})}}function h(e,t){return w(e)||x(e,t)||b(e,t)||g()}function g(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function b(e,t){if(e){if(\"string\"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){var n=null==e?null:\"undefined\"!=typeof Symbol&&e[Symbol.iterator]||e[\"@@iterator\"];if(null!=n){var r,o,a,u,c=[],i=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);i=!0);}catch(l){s=!0,o=l}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(s)throw o}}return c}}function w(e){if(Array.isArray(e))return e}var S=function(i){var s=i.siteURL,l=i.lang,d=i.apiKey,p=i.mail,v=\"urdu\"===l?\"https://nanivoice-backend-mocha.vercel.app\":\"https://justvoicebackend-vrtx.vercel.app\",m=h((0,e.useState)(!0),2),g=m[0],b=m[1];(0,e.useEffect)(function(){(function(){var e=y(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(\"api-justautofy.vercel.app/api/verify\",{method:\"POST\",body:JSON.stringify({apiKey:d,siteURL:window.location.host,productName:\"voicebot\",email:p})});case 2:200===e.sent.status&&b(!0);case 4:case\"end\":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[]);var _={role:\"system\",content:\"urdu\"===l?\"میں یہاں آپ کے سوالات میں مدد کرنے کے لئے نانی ڈاٹ پی کے اے آئی اسسٹنٹ ہوں. آپ مجھ سے ہماری مصنوعات اور خدمات کے بارے میں کچھ پوچھ سکتے ہیں.\":\"I am an AI Assistant of \".concat(s,\"  here to help you with your queries. You can ask me anything about our products and services.\")},x=h((0,e.useState)(!1),2),w=x[0],S=x[1],j=h((0,e.useState)([]),2),k=j[0],O=j[1],I=h((0,e.useState)(\"\"),2),R=I[0],E=I[1],P=h((0,e.useState)([_]),2),A=P[0],q=P[1],N=function(){S(!w)};(0,e.useEffect)(function(){console.log(w)},[w]);var M=(0,c.default)(),T=M.startRecording,B=M.stopRecording,D=(M.togglePauseResume,M.recordingBlob),C=M.isRecording,J=(M.isPaused,M.recordingTime,function(){var e=y(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B();case 1:case\"end\":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}());(0,e.useEffect)(function(){L(D)},[D]);var L=function(){var e=y(regeneratorRuntime.mark(function e(t){var n,r,o,a,u,c,i,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={role:\"user\",content:\"typing...\"},q(function(e){return[].concat(f(e),[n])}),e.prev=2,(r=new FormData).append(\"file\",t,\"audio.wav\"),r.append(\"language\",\"en\"),o=v+(\"urdu\"==l?\"/api/gcloud/speech2text\":\"/api/voicechat\"),e.next=10,fetch(o,{method:\"POST\",body:r});case 10:if(!(a=e.sent).ok){e.next=21;break}return e.next=14,a.json();case 14:u=e.sent,c=u.text,i=A.filter(function(e){return\"typing...\"!==e.content}),q(function(e){return f(i)}),K(c),e.next=22;break;case 21:console.error(\"Failed to send audio to the API.\");case 22:e.next=29;break;case 24:e.prev=24,e.t0=e.catch(2),s=A.filter(function(e){return\"typing...\"!==e.content}),q(function(e){return f(s)}),console.error(\"Error sending audio to the API:\",e.t0);case 29:case\"end\":return e.stop()}},e,null,[[2,24]])}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=y(regeneratorRuntime.mark(function e(t){var n,r,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=v+\"/api/readvoice\",e.prev=1,e.next=4,fetch(n,{method:\"POST\",body:JSON.stringify({text:t,voiceId:\"ur\"==l?\"IKne3meq5aSn9XLyUdCD\":\"EXAVITQu4vr4xnSDxMaL\"})});case 4:if(200!==(r=e.sent).status){e.next=12;break}return e.next=8,r.arrayBuffer();case 8:o=e.sent,a=new AudioContext,u=a.createBufferSource(),a.decodeAudioData(o,function(e){u.buffer=e,u.connect(a.destination),u.start()});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(\"error\",e.t0);case 17:case\"end\":return e.stop()}},e,null,[[1,14]])}));return function(t){return e.apply(this,arguments)}}();(0,e.useEffect)(function(){A.length>1&&\"system\"!==A[A.length-1].role&&\"typing...\"!==A[A.length-1].content&&W()},[A,k]);var K=function(e){var t={role:\"user\",content:e};q(function(e){return[].concat(f(e),[t])})},W=function(){var e=y(regeneratorRuntime.mark(function e(){var t,n,r,o,c,i,d,p,m,y,h,g,b,_,x;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={role:\"system\",content:\"typing...\"},q(function(e){return[].concat(f(e),[t])}),n=\"chat_memory\",r=u.default.get(n)?JSON.parse(u.default.get(n)):\"\",o={role:\"system\",content:\"this is the summary of conversation i know \"+r},e.prev=5,c={conversationId:u.default.get(\"convoId\")?u.default.get(\"convoId\"):\"1234\",textInput:A[A.length-1].content,siteURL:s},i=v+\"/api/chatgpt/openai\",e.next=10,a.default.post(i,{input:c,summary:o});case 10:return d=e.sent,e.next=13,d.data;case 13:if(p=e.sent,m=p.result,y=p.summary,h=p.convoId,c.conversationId.length<5&&u.default.set(\"convoId\",h),!(m.content.length>0)){e.next=28;break}return g=A.filter(function(e){return\"typing...\"!==e.content}),q(function(e){return[].concat(f(g),[m])}),console.log(\"result\"),e.next=24,U(m.content);case 24:u.default.remove(n),u.default.set(n,JSON.stringify(y)),e.next=33;break;case 28:O(m.result),b=A.filter(function(e){return\"typing...\"!==e.content}),q(function(e){return[].concat(f(b),[m])}),u.default.remove(n),u.default.set(n,JSON.stringify(y));case 33:e.next=44;break;case 35:return e.prev=35,e.t0=e.catch(5),\"معذرت، میں آپ کے سوال کو سمجھنے کے قابل نہیں ہوں۔ دوبارہ کوشش کریں.\",_={role:\"system\",content:\"en\"==l?\"Sorry, I am not able to understand your query. Please try again.\":\"معذرت، میں آپ کے سوال کو سمجھنے کے قابل نہیں ہوں۔ دوبارہ کوشش کریں.\"},x=A.filter(function(e){return\"typing...\"!==e.content}),q(function(e){return[].concat(f(x),[_])}),e.next=43,U(_.content);case 43:console.error(\"Error:\",e.t0);case 44:case\"end\":return e.stop()}},e,null,[[5,35]])}));return function(){return e.apply(this,arguments)}}();return e.default.createElement(\"div\",{className:\"justvoice__widget\"},e.default.createElement(\"div\",{className:\"justvoice__chatBtn \".concat(w?\"justvoice__chatBtn__open\":\"justvoice__chatBtn__close\")},e.default.createElement(t.default,{prompt:R,handleTextSubmit:function(e){\"\"!=e?(K(e),E(\"\")):alert(\"no input\")},toggleChat:N,chatOpen:w})),e.default.createElement(\"div\",{className:\"\".concat(w?\"justvoice__chat__size__open\":\"justvoice__chat__size__close\",\" justvoice__chat__main\")},e.default.createElement(n.default,{toggleChat:N}),e.default.createElement(\"div\",{className:\"justvoice__chat__x2b3f5h9c8\"},g?e.default.createElement(o.default,{messages:A}):e.default.createElement(\"h3\",null,\"Please Subscribe\")),g&&e.default.createElement(r.default,{prompt:R,setPrompt:E,handleStartRecording:function(){T()},handleStopRecording:J,isRecording:C})))},j=S;exports.default=j;"},"sourceMaps":null,"error":null,"hash":"b35b6214287587daeeb7a4df60a34530","cacheData":{"env":{}}}